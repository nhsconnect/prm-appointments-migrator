(this["webpackJsonpmigration-portal"]=this["webpackJsonpmigration-portal"]||[]).push([[0],{27:function(e,t,n){e.exports=n(51)},50:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(22),c=n.n(s),o=n(12),i="prm-appointments-migrator",l=function(){return r.a.createElement("header",{className:"nhsuk-header nhsuk-header--transactional",role:"banner","data-testid":"header"},r.a.createElement("div",{className:"nhsuk-width-container nhsuk-header__container"},r.a.createElement("div",{className:"nhsuk-header__logo"},r.a.createElement(o.b,{className:"nhsuk-header__link",to:"/".concat(i),"aria-label":"NHS homepage"},r.a.createElement("svg",{className:"nhsuk-logo nhsuk-logo--white",xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 40 16"},r.a.createElement("path",{fill:"#fff",d:"M0 0h40v16H0z"}),r.a.createElement("path",{fill:"#005eb8",d:"M3.9 1.5h4.4l2.6 9h.1l1.8-9h3.3l-2.8 13H9l-2.7-9h-.1l-1.8 9H1.1M17.3 1.5h3.6l-1 4.9h4L25 1.5h3.5l-2.7 13h-3.5l1.1-5.6h-4.1l-1.2 5.6h-3.4M37.7 4.4c-.7-.3-1.6-.6-2.9-.6-1.4 0-2.5.2-2.5 1.3 0 1.8 5.1 1.2 5.1 5.1 0 3.6-3.3 4.5-6.4 4.5-1.3 0-2.9-.3-4-.7l.8-2.7c.7.4 2.1.7 3.2.7s2.8-.2 2.8-1.5c0-2.1-5.1-1.3-5.1-5 0-3.4 2.9-4.4 5.8-4.4 1.6 0 3.1.2 4 .6"}),r.a.createElement("img",{alt:"nhs-logo",src:"https://assets.nhs.uk/images/nhs-logo.png"})))),r.a.createElement("div",{className:"nhsuk-header__transactional-service-name"},r.a.createElement("a",{className:"nhsuk-header__transactional-service-name--link",href:"/"},"Appointments Migrator"))))},u=n(25),p=n(5),m=n(8),d=n(2),h=n.n(d),f=n(4),g=n(1),b={small:Object(g.a)({marginBottom:"1rem"}),regular:Object(g.a)({marginBottom:"2rem"}),large:Object(g.a)({marginBottom:"4rem"})},E=Object(g.a)({margin:"0",padding:"0",textIndent:"0",listStyleType:"none"}),v=(Object(g.a)({float:"right"}),Object(g.a)({"&:hover":{boxShadow:"0 0 0 0px"},textDecoration:"none"}),Object(g.a)({borderBottom:"4px solid #005eb8",marginBottom:"1rem"})),w="0px 0px 5px 0px rgba(0, 0, 0, 0.3)",k=function(e){var t=e.items,n=e.icon,a=void 0!==n&&n,s=e.success,c=void 0===s||s,o=Object(g.a)({width:"100%",backgroundColor:c?"transparent":"#ffb5b5",marginTop:"-1rem",marginBottom:"1rem",padding:"0.5rem"}),i=Object(g.a)({verticalAlign:"middle"});return r.a.createElement("ul",{className:E},r.a.createElement("div",{className:b.large},function(e){return e.map((function(e){var t=e.practitioner,n=e.location,s=e.start,l=e.end,u=e.description,p=e.patientId,m=e.schedule,d=e.errorMessage;return r.a.createElement("li",{className:b.large,key:p},r.a.createElement("div",null,r.a.createElement("hr",{className:v}),r.a.createElement("div",{className:o},a&&function(e){return{true:r.a.createElement("svg",{className:"".concat(i," nhsuk-icon nhsuk-icon__tick"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true"},r.a.createElement("path",{strokeWidth:"4",strokeLinecap:"round",d:"M18.4 7.8l-8.5 8.4L5.6 12"})),false:r.a.createElement("svg",{className:"".concat(i," nhsuk-icon nhsuk-icon__cross"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true"},r.a.createElement("path",{d:"M17 18.5c-.4 0-.8-.1-1.1-.4l-10-10c-.6-.6-.6-1.6 0-2.1.6-.6 1.5-.6 2.1 0l10 10c.6.6.6 1.5 0 2.1-.3.3-.6.4-1 .4z"}),r.a.createElement("path",{d:"M7 18.5c-.4 0-.8-.1-1.1-.4-.6-.6-.6-1.5 0-2.1l10-10c.6-.6 1.5-.6 2.1 0 .6.6.6 1.5 0 2.1l-10 10c-.3.3-.6.4-1 .4z"}))}[e.toString()]}(c),r.a.createElement("span",{className:i},r.a.createElement("em",null,d))),r.a.createElement("h4",null,p),r.a.createElement("ul",null,r.a.createElement("li",null,s," \u27a1 ",l),r.a.createElement("li",null,t),r.a.createElement("li",null,n),r.a.createElement("li",null,m)),r.a.createElement("div",null,u)))}))}(t)))},x=n(10),O={prod:"prod",none:"none"},j={api:O.none,domain:""},N=function(){return O[j.api]||O.none},T=function(){return"https://".concat(j.domain,".ngrok.io")},S=[{description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Laura Barry",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Les Fawcett",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"},{description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Emily Margo",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Parth Aggarwal",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"},{description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Natasha Desai",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Tina Coxhead",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"}],y=[{success:!1,errorMessage:"Could not find corresponding slot",description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Laura Barry",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{success:!1,errorMessage:"Could not find corresponding slot",description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Les Fawcett",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"},{success:!0,errorMessage:"",description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Emily Margo",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{success:!0,errorMessage:"",description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Parth Aggarwal",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"},{success:!0,errorMessage:"",description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Natasha Desai",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{success:!0,errorMessage:"",description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Tina Coxhead",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"}],A=n(14),M=function(){var e=Object(f.a)(h.a.mark((function e(t){var n,a,r,s,c,o,i,l,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,a=t.headers,r=void 0===a?{}:a,s=t.method,c=void 0===s?"GET":s,o=t.body,i={headers:r,method:c},l=o?Object(A.a)({},i,{body:o}):i,e.next=5,fetch(n,l).catch((function(e){console.log("error",e)}));case 5:if(!(u=e.sent)){e.next=10;break}return e.next=9,u.json();case 9:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=n(26),H=function(e){return e.map((function(e){var t=e.start,n=e.end,a=Object(D.a)(e,["start","end"]);return Object(A.a)({start:new Date(t).toLocaleString(),end:new Date(n).toLocaleString().split(",")[1]},a)}))},G=function(){var e=Object(f.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},Object(x.a)(n,O.prod,_),Object(x.a)(n,O.none,I),a=n,e.next=3,a[N()](t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(f.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(T,"/book-appointments"),e.next=3,M({url:n,body:JSON.stringify(t),method:"POST"});case 3:return a=e.sent,e.abrupt("return",H(a));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){return H(y)},B=function(e){var t=e.appointments,n=Object(a.useState)([]),s=Object(p.a)(n,2),c=s[0],o=s[1],i=Object(a.useState)([]),l=Object(p.a)(i,2),u=l[0],m=l[1],d=function(){var e=Object(f.a)(h.a.mark((function e(){var n,a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(t);case 2:n=e.sent,a=n.filter((function(e){return e.success})),r=n.filter((function(e){return!e.success})),o(a),m(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){d()})),r.a.createElement("div",{className:b.large},r.a.createElement("h2",{className:b.regular},"Failed transfers"),r.a.createElement("div",{className:b.regular},u.length," transfers failed."),r.a.createElement(k,{items:u,icon:!0,success:!1}),r.a.createElement("h2",{className:b.regular},"Successful transfers"),r.a.createElement("div",{className:b.regular},c.length," transfers successful."),r.a.createElement(k,{items:c,icon:!0}))},P=function(){var e=Object(f.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},Object(x.a)(t,O.prod,F),Object(x.a)(t,O.none,L),n=t,e.next=3,n[N()]();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(f.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(T(),"/findappointments"),e.next=3,M({url:t,method:"GET"});case 3:return n=e.sent,e.abrupt("return",H(n));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(f.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=S,e.abrupt("return",H(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(e){var t=e.setNumberAppts,n=e.startTransferring,s=e.setAppointmentsHook,c=Object(a.useState)([]),o=Object(p.a)(c,2),i=o[0],l=o[1],u=function(){var e=Object(f.a)(h.a.mark((function e(){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:n=e.sent,l(n),t(n.length),s(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){u()})),r.a.createElement("div",{className:b.large},r.a.createElement("p",{className:b.regular},"Found ",i.length," in current solution between ",r.a.createElement("b",null,"today")," and"," ",r.a.createElement("b",null,"13/04/2020"),"."),r.a.createElement("button",{className:"nhsuk-button",onClick:function(){return n(q.transferring)}},"Transfer all appointments"),r.a.createElement(k,{items:i}))},z=function(e){var t=e.nextPage,n=Object(a.useReducer)((function(e){return e<100||e<100?e+10:100}),0),s=Object(p.a)(n,2),c=s[0],o=s[1],l=Object(a.useRef)(0),u=Object(g.a)({width:"50%",backgroundColor:"#d8dde0",height:"1rem",borderRadius:"50px",boxShadow:w}),d=Object(g.a)({width:"".concat(c,"%"),backgroundColor:"#005eb8",height:"100%",borderRadius:"inherit",transition:"width 0.5s ease-out"}),h=Object(m.f)();return Object(a.useEffect)((function(){var e=setInterval((function(){l.current<100?(l.current+=10,o()):(clearInterval(e),h.push("/".concat(i,"/").concat(t)))}),500)})),r.a.createElement("div",{className:u},r.a.createElement("div",{className:d}))},R=function(){return r.a.createElement("div",{className:b.large},r.a.createElement("div",{className:b.regular},r.a.createElement("b",null,"Finding all appointments...")),r.a.createElement(z,{nextPage:"appointments"}))},W=function(e){var t=e.numberAppts;return r.a.createElement("div",{className:b.large},r.a.createElement("div",{className:b.regular},r.a.createElement("b",null,"Transferring ",t," appointments...")),r.a.createElement(z,{nextPage:"booked"}))},J=function(e){var t=e.startFinding,n=Object(g.a)({padding:"1rem",borderRadius:"1rem",fontSize:"1rem",fontWeight:"bold",boxShadow:w,width:"50%"}),s=Object(g.a)({cursor:"pointer"});return r.a.createElement(a.Fragment,null,r.a.createElement("div",{className:b.small},"Using patient NHS numbers from:"),r.a.createElement("p",{className:n},"patient.nhsNumbers.csv"),r.a.createElement("div",{className:"nhsuk-action-link"},r.a.createElement("button",{className:"".concat(s," nhsuk-action-link__link"),onClick:function(){return t(q.finding)}},r.a.createElement("svg",{className:"nhsuk-icon nhsuk-icon__arrow-right-circle",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true"},r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),r.a.createElement("path",{d:"M12 2a10 10 0 0 0-9.95 9h11.64L9.74 7.05a1 1 0 0 1 1.41-1.41l5.66 5.65a1 1 0 0 1 0 1.42l-5.66 5.65a1 1 0 0 1-1.41 0 1 1 0 0 1 0-1.41L13.69 13H2.05A10 10 0 1 0 12 2z"})),r.a.createElement("span",{className:"nhsuk-action-link__text"},"Find all appointments"))))},U={marginBottom:"0px!important",color:"lightgray"},$=function(){return r.a.createElement("div",{className:"".concat(Object(g.a)(U)," nhsuk-body-s")},"API: ",T())},q={finding:"finding",transferring:"transferring"},K=function(){var e=Object(a.useState)(),t=Object(p.a)(e,2),n=t[0],s=t[1],c=Object(a.useState)(""),o=Object(p.a)(c,2),l=o[0],u=o[1],d=Object(a.useState)([]),h=Object(p.a)(d,2),f=h[0],g=h[1];return r.a.createElement(a.Fragment,null,r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:"/".concat(i)},l===q.finding?r.a.createElement(R,null):r.a.createElement(J,{startFinding:u})),r.a.createElement(m.a,{path:"/".concat(i,"/appointments")},l===q.transferring?r.a.createElement(W,{numberAppts:n}):r.a.createElement(C,{startTransferring:u,setNumberAppts:s,setAppointmentsHook:g})),r.a.createElement(m.a,{path:"/".concat(i,"/booked")},r.a.createElement(B,{appointments:f}))),"none"!==N()&&r.a.createElement($,null))},Q=function(){var e;e=Object(u.parse)(window.location.search,{parseBooleans:!0}),Object.entries(e).forEach((function(e){var t=Object(p.a)(e,2),n=t[0],a=t[1];j[n]=a}));var t=Object(g.a)({maxWidth:"800px",margin:"0 auto",padding:"1rem"});return r.a.createElement(a.Fragment,null,r.a.createElement(l,null),r.a.createElement("div",{className:t},r.a.createElement(K,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(50);c.a.render(r.a.createElement(o.a,null,r.a.createElement(Q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[27,1,2]]]);
//# sourceMappingURL=main.0b336f58.chunk.js.map